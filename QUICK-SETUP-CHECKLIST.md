# 🚀 快速配置检查清单

## 第一阶段：微信开放平台准备（1-3天）

### ☐ 任务1：注册开放平台账号
- [ ] 访问 https://open.weixin.qq.com/
- [ ] 注册企业账号
- [ ] 准备企业资料（营业执照、法人身份证）
- [ ] 提交认证（费用：¥300）
- [ ] 等待审核通过（1-3个工作日）

### ☐ 任务2：创建网站应用
- [ ] 登录开放平台管理中心
- [ ] 创建网站应用
- [ ] 填写应用信息：
  ```
  应用名称：汉克运营知识库
  应用简介：运营知识分享平台
  应用官网：http://47.108.70.67
  授权回调域：47.108.70.67
  ```
- [ ] 提交审核
- [ ] 等待审核通过
- [ ] **记录AppID和AppSecret**：
  ```
  网站AppID: wx________________
  网站AppSecret: ________________________________
  ```

### ☐ 任务3：配置小程序
- [ ] 登录小程序后台 https://mp.weixin.qq.com/
- [ ] 开发 > 开发设置
- [ ] **记录AppID和AppSecret**：
  ```
  小程序AppID: wxe68fea6a2d9dd365
  小程序AppSecret: ________________________________
  ```
- [ ] 配置服务器域名：
  ```
  request合法域名：http://47.108.70.67
  ```

### ☐ 任务4：绑定UnionID
- [ ] 开放平台 > 管理中心 > 公众号/小程序管理
- [ ] 点击"绑定小程序"
- [ ] 输入小程序AppID：wxe68fea6a2d9dd365
- [ ] 小程序后台确认绑定
- [ ] 验证绑定成功 ✅

---

## 第二阶段：WordPress配置（10分钟）

### ☐ 任务5：上传主题
- [ ] 上传主题包：`红人汉克手册主题-云端同步版.zip`
- [ ] WordPress后台 > 外观 > 主题 > 上传主题
- [ ] 启用主题

### ☐ 任务6：配置微信AppID
- [ ] 找到文件：`wechat-login.php`
- [ ] 编辑配置：
  ```php
  define('WECHAT_WEB_APPID', 'wx________________');
  define('WECHAT_WEB_SECRET', '________________________________');
  define('WECHAT_MP_APPID', 'wxe68fea6a2d9dd365');
  define('WECHAT_MP_SECRET', '________________________________');
  ```
- [ ] 保存文件

### ☐ 任务7：上传回调文件
- [ ] 将`wechat-callback.php`上传到网站根目录
- [ ] 位置：与`wp-config.php`同级
- [ ] 验证访问：http://47.108.70.67/wechat-callback.php（应该看到空白或跳转）

### ☐ 任务8：运行页面创建脚本
- [ ] 访问：http://47.108.70.67/create-pages.php
- [ ] 等待脚本执行完成
- [ ] 看到："创建了 8 个新页面" ✅
- [ ] **删除脚本文件**以确保安全

### ☐ 任务9：测试API端点
- [ ] 访问：http://47.108.70.67/wp-json/hank-wechat/v1
- [ ] 应该看到：
  ```json
  {
    "namespace": "hank-wechat/v1",
    "routes": {
      "/miniprogram/login": ...,
      "/validate": ...,
      "/packages": ...,
      "/search-history": ...
    }
  }
  ```

---

## 第三阶段：小程序配置（5分钟）

### ☐ 任务10：配置API地址
- [ ] 编辑：`miniprogram/app.js`
- [ ] 修改：
  ```javascript
  apiUrl: 'http://47.108.70.67/wp-json/hank-wechat/v1'
  ```
- [ ] 保存文件

### ☐ 任务11：导入小程序项目
- [ ] 下载微信开发者工具
- [ ] 导入项目：
  ```
  项目目录：/Users/hankchan/Downloads/Hank/红人汉克手册网站/miniprogram
  AppID：wxe68fea6a2d9dd365
  项目名称：汉克运营知识库
  ```

### ☐ 任务12：开启调试模式
- [ ] 详情 > 本地设置
- [ ] 勾选"不校验合法域名、web-view（业务域名）、TLS版本以及HTTPS证书"
- [ ] 勾选"不校验安全域名、TLS版本以及HTTPS证书"

### ☐ 任务13：测试小程序
- [ ] 点击"编译"
- [ ] 查看控制台，应该看到：
  ```
  小程序启动
  获取code成功: 061xxxxx
  登录API响应: {success: true, token: "...", userInfo: {...}}
  登录成功，用户信息: {...}
  开始执行云端数据同步...
  ```

---

## 第四阶段：功能测试（10分钟）

### ☐ 测试1：网站扫码登录
- [ ] 访问：http://47.108.70.67
- [ ] 点击"微信登录"按钮
- [ ] 扫描二维码
- [ ] 确认登录
- [ ] 页面显示用户头像 ✅

### ☐ 测试2：小程序登录
- [ ] 打开小程序
- [ ] 自动登录
- [ ] 进入"我的"页面
- [ ] 看到用户信息 ✅

### ☐ 测试3：UnionID验证
- [ ] WordPress后台 > 用户
- [ ] 查看自定义字段
- [ ] 验证有`wechat_unionid` ✅

### ☐ 测试4：搜索记录同步
- [ ] 小程序搜索"用户增长"
- [ ] 网站访问"我的"页面
- [ ] 看到搜索记录 ✅

### ☐ 测试5：资料包同步
- [ ] 小程序下载资料包
- [ ] 网站访问"我的"页面
- [ ] 看到资料包记录 ✅

### ☐ 测试6：跨设备同步
- [ ] 设备A登录并操作
- [ ] 设备B登录
- [ ] 看到相同数据 ✅

---

## 🎯 配置完成验证

全部完成后，您应该能够：

✅ **网站端**：
- 点击"微信登录"按钮
- 扫码登录
- 访问"我的"页面看到资料包和搜索记录

✅ **小程序端**：
- 自动登录
- 搜索运营问题
- 下载资料包
- 在"我的"页面看到所有记录

✅ **数据互通**：
- 小程序的数据在网站上能看到
- 网站的数据在小程序上能看到
- 跨设备数据一致

---

## 📝 配置信息记录表

**请填写以下信息并妥善保管**：

```
=================================================
          微信开放平台配置信息
=================================================

【网站应用】
AppID: wx________________________________
AppSecret: ________________________________________
授权回调域: _____________________________________

【小程序】
AppID: wxe68fea6a2d9dd365
AppSecret: ________________________________________

【WordPress】
网站地址: http://47.108.70.67
API地址: http://47.108.70.67/wp-json/hank-wechat/v1

【配置时间】
注册时间: ____年__月__日
认证时间: ____年__月__日
配置完成: ____年__月__日

【备注】

=================================================
```

---

## 🆘 遇到问题？

1. **查看文档**：
   - WECHAT-OPEN-PLATFORM-SETUP.md（详细配置）
   - DATA-SYNC-GUIDE.md（数据同步方案）
   - WECHAT-LOGIN-DEPLOY-GUIDE.md（部署指南）

2. **检查日志**：
   - WordPress：开启WP_DEBUG查看错误
   - 小程序：开发者工具控制台

3. **常见错误码**：
   - 40029：code无效
   - 40163：code已使用
   - 41001：缺少access_token
   - 42001：access_token过期

---

**准备好了吗？开始配置吧！** 💪
